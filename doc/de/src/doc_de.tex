\documentclass[12pt, a4paper, titlepage, hidelinks]{scrreprt}	
\input{src/preamble}

\hypersetup{
 pdfauthor={Mathias Garbe},
 pdftitle={Projektarbeit Asteroids Dokumentation},
 pdfsubject={},
 pdfkeywords={}
}

\title{Projektarbeit Asteroids}
\subtitle{Dokumentation und Ausblick}
\author{Mathias Garbe}

\begin{document}

\pagenumbering{roman}
\maketitle

\microtypesetup{protrusion=false}
\tableofcontents
\microtypesetup{protrusion=true}

\clearpage

\pagenumbering{arabic}

\chapter{Dokumentation}



\section{Überblick und Ordnerstruktur}

\dirtree{%
.1 /.
.2 cmake \DTcomment{Hilfsskripte für CMake}.
.3 VisualStudio \DTcomment{Visual Studio Solution Template}.
.2 data.
.3 shader \DTcomment{Shader-Quelldateien}.
.2 doc \DTcomment{Dokumentation}.
.3 de.
.2 src \DTcomment{Quelldateien}.
.3 Game \DTcomment{Logik des Spiels}.
.4 Components \DTcomment{Komponenten der Spiel-Entitäten}.
.3 Graphics \DTcomment{Grafik-Subsystem}.
.4 Geometry \DTcomment{Geometrie}.
.4 Shader \DTcomment{Shaderverwaltung}.
.4 Window \DTcomment{Fensterverwaltung}.
.3 Math \DTcomment{Mathe- und Vektorsubsystem}.
}

\section{Abhängigkeiten}

Das Projekt hat folgende Software-Abhängigkeiten:
\begin{itemize}
  \item CMake >=2.8 (Download von \url{http://www.cmake.org})
  \item GLFW >=3.0.4 (Download von \url{http://www.glfw.org})
  \item GLEW >=1.10.0 (Download von \url{http://glew.sourceforge.net})
\end{itemize}

Unter Linux sind diese Abhängigkeiten meist im jeweiligen Paket-Manager verfügbar und einfach zu installieren.

Auch ist ein C++11-fähiger Compiler notwendig. Dies ist unter Linux/Mac OS X \texttt{gcc} in Version 4.7 oder höher sowie \texttt{clang} in Version 3.0 oder höher und unter Microsoft Windows \texttt{Visual Studio 2013} oder höher. Zusätzlich wird noch eine Grafikkarte inklusiver passender Treiber benötigt die mit dem OpenGL 3 Core Profile kompatibel sind.

\section{Buildsystem}
Zum Bauen des Projekts wird CMake verwendet. CMake erzeugt aus den Skriptdatein (\texttt{CMakeFiles.txt}) Makefiles und Projektdateien für eine Reihe von IDEs. Im Zuge der Entwicklung wurde das sowohl mit der Visual Studio Solution, Sublime Text Projekt und GNU Makefiles gearbeitet.  

\subsection{Einrichten von CMake}
\label{cmake-setup}
Für den Fall dass die erforderten Abhängigkeiten nicht mit einem Paketmanager installiert wurden (oder unter Windows entwickelt wird) kann eine \texttt{UserDefinitions.cmake} im Hauptverzeichnis erstellt werden, mit welcher die Pfade von GLFW und GLEW angegeben werden können. Die Datei \texttt{UserDefinitions.cmake.example} kann dabei als Vorlange benutzt werden.

Der Inhalt der \texttt{UserDefinitions.cmake} in einer Windows-Entwicklungsumgebung könnte zum Beispiel so aussehen:

\mintedfile{cmake}{listings/UserDefinitions.cmake.windows}{Ein Beispiel für eine \texttt{UserDefinitions.cmake} unter Windows. Die Windows-Typischen umgekehrten Schrägstriche (Backslash) müssen dabei durch normale Schrägstriche ersetzt werden.}{lst:UserDefinitions.cmake}

Es ist darauf zu achten, dass die \texttt{UserDefinitions.cmake} nicht in die Versionsverwaltung eingecheckt wird, da sie für jede Entwicklungsumgebung spezifisch ist. Deswegen ist diese Datei auch in der \texttt{.gitignore} aufgeführt.

\subsection{Kompilieren des Projekts}
Um die Projektdateien zu bauen öffnet man am einfachsten die Konsole und wechselt in das Projektverzeichnis. Dort können dann mit den folgenden Befehlen die Projektdateien erzeugt werden:
\clicommand{>~mkdir~build\\ >~cd~build\\ >~cmake~..}

Anstatt \texttt{>~cmake ..} zu benutzen kann auch mit \texttt{>~cmake-gui} eine grafische Oberfläche ausgeführt werden, über welche nun CMake eingerichtet werden kann. Falls CMake die Abhänigkeiten GLFW oder GLEW nicht finden kann so wird dies als Fehler ausgegeben und die Ausführung abgebrochen. In diesem Fall muss eine \texttt{UserDefinitions.cmake} erstellt werden oder die Pfadangaben in einer vorhandenen überprüft werde (siehe \autoref{cmake-setup}).

\paragraph{Linux und Mac OS X}
Unter Linux und Mac OS X kann danach per \texttt{>~make} das Projekt gebaut werden. Das Spiel benötigt zum Ausführen Zugriff auf die Shader-Quelldateien, welche sich in \texttt{/data/shader/} befinden. Da das Spiel diese Shader-Dateien relativ zum aktuellen Arbeitsverzeichnis erwartet, muss das Spiel im Hauptverzeichnis gestartet werden:
\clicommand{>~cd ~..\\ >~./build/src/asteroids}

\paragraph{Windows}
Unter Windows kann die erstellte Visual Studio Solution mit Visual Studio 2013 geöffnet und das Projekt gebaut sowie gestartet werden. Die Einrichtung des korrekten Arbeitsverzeichnis hat CMake mithilfe einer Solution Template in \texttt{/cmake/VisualStudio/} übernommen und muss somit nicht von Hand erledigt werden.

\section{Engine-Design}
\subsection{Fensterverwaltung}
\subsection{Shaderverwaltung}
\subsection{Zeichnen von Geometrie}
\subsection{Physik}
\section{Spiel-Design}
\subsection{Komponenten}

\chapter{Ausblick}
\section{Portierung auf andere Grafiksysteme}
\section{Multithreading}
\end{document}